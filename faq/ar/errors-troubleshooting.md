# الأخطاء واستكشاف الأخطاء

## لماذا أحصل على رسالة خطأ عندما أحاول تحميل ملف؟

إذا كان الملف كبيرا، قد تتجاوز حدود تحميل حجم الملف. يمكنك زيادة الحدود التالية في ملف php ini الخاص بك، أو اطلب من المسؤول زيادة الحدود إذا لم يكن لديك حق الوصول إلى ملفات الموقع:

- `حجم البريد_الأقصى_`
- `تحميل_حد أقصى لملف`
- `حد الذاكرة_`
- `الحد الأقصى للتنفيذ`

يمكنك أيضًا التحقق من أن لديك أذونات الملف تم تعيينها بشكل صحيح.

## كيف يمكنني إصلاح هذا النص الغريب على موقعي الذي يبدو مثل #navigation.journalHelp##؟

عندما ترى النص في موقعك مع علامات الهاشتاء، مثل `#default.journalSettings.emailSignature##`، فهذا يعني أن هناك ترجمة مفقودة. كل النصوص التي تراها على موقع OJS أو OMP أو OPS تأتي من ملفات اللغة المحلية, اعتماداً على اللغة التي تم تثبيتها واختيارها لموقعك. يحتوي كل ملف محلي على مجموعة من "مفاتيح الرسائل" أو أجزاء من النص التي تحتاج إلى أن يضيفها المترجمون. إذا كان مفتاح الرسالة مفقوداً، فإن البرنامج سيعرض الإشارة إلى مفتاح الرسالة بدلاً من ذلك.

على سبيل المثال، إذا كانت الترجمة مفقودة لرابط قائمة المحفوظات، فسيظهر رابط القائمة كـ `#archive.archives##`.

لإصلاح هذا، تحتاج إلى إضافة الترجمة الناقصة لمفتاح الرسالة. أفضل طريقة هي استخدام أداة ترجمة برمجياتنا Weblate، لذلك سيتم المساهمة بالترجمة مرة أخرى إلى مجتمع مستخدمي PKP. [دليل ترجمة PKP](https://docs.pkp.sfu.ca/translating-guide/en/) يشرح كيفية القيام بذلك. فقط لتعديل الترجمة على موقعك المحلي، يمكنك استخدام [إضافة محلية مخصصة](https://docs.pkp.sfu.ca/translating-guide/en/customize-locale).

## لماذا تظهر الشخصيات بشكل غريب على موقعي؟

مشاكل ترميز الأحرف شائعة ويمكن أن تسبب مشاكل عند نقل تثبيت برنامج PKP إلى خادم مختلف. راجع [دليل مدير PKP](https://docs.pkp.sfu.ca/admin-guide/en/troubleshooting#character-encoding) للحصول على معلومات حول مشاكل ترميز الأحرف.

## كيف يمكنني منع البريد المزعج؟

يرجى الاطلاع على [دليل مدير PKP - إدارة البريد المزعج](https://docs.pkp.sfu.ca/admin-guide/en/securing-your-system#managing-spam).

## ماذا تعني رسالة الخطأ المربكة هذه؟

عندما تحصل على رسالة خطأ على موقعك، فإنه عادة ما يكون مختصراً ولا يعطي الكثير من المعلومات. وعلى سبيل المثال:

- الصفحة 404 غير موجودة
- حدث خطأ في قاعدة البيانات
- ممنوع - ليس لديك الصلاحية للوصول
- خطأ HTTP 500

تحتاج إلى البحث في مكان آخر للحصول على مزيد من المعلومات حول الخطأ قبل أن تتمكن من حله.

### أولاً، تحقق من سجل الأخطاء PHP الخاص بك

سيتوقف موقع سجل الأخطاء في PHP على تكوين موفر الاستضافة الخاص بك، ولكن عادة ما يكون ملف يسمى `error_log` في مكان ما داخل حسابك. إذا كنت تقوم بتشغيل الخادم الخاص بك، ستكون السجلات عادة في مكان ما مثل `/var/log` أو `/var/log/apache`.

من النادر وغير الشائع أن لا يوفر مضيف الويب الخاص بك الوصول إلى سجل الأخطاء الخاص بك. إذا كان مزود الخدمة لديك قاعدة معرفية، فإنه عادة ما يصف كيفية العثور على سجلاتك هناك.

في معظم المضيفين المشتركين، هناك دليل يسمى "السجلات" أو شيء مماثل.

قد تبدو سجلات الأخطاء مربكة إذا لم تكن على دراية بها ولكنك تريد البحث عن كلمة "خطأ" وغيرها من الكلمات الرئيسية التي تشير إلى ما يمكن أن يحدث خطأ. غالبا ما يشير خطأ إلى ملف معين في تثبيت OJS الخاص بك وسطر من التعليمات البرمجية في ذلك الملف. يمكنك فتح الملف والعثور على السطر لمحاولة فهم الخطأ. من المرجح أن المستخدمين الآخرين واجهوا نفس المشكلة حتى يمكنك البحث عن الخطأ والحل على [منتدى دعم PKP](https://forum.pkp.sfu.ca/).

إليك بعض رسائل الخطأ الشائعة والحلول الممكنة.

### معايير صارمة أو أساليب مهملة

أمثلة:

```
معايير PHP الصارمة: الأسلوب غير الثابت للطلب: :getContext() لا ينبغي استدعاؤه بشكل استبدادي، بافتراض أن $this من السياق غير المتوائم في /home/wwwroot/lanmp5.3/domain/openjournal.org/web/lib/pkp/classes/plugins/ThemePlugin.inc.php على السطر 409
```

```
PHP مهمل: لا ينبغي الاتصال بالأسلوب غير الثابت PKPrequest::_checkThis() في /home/gayanabo/public_html/ojs/lib/pkp/classes/core/PKPrequest.inc.php على السطر 396
```

ويمكن تجاهل أي رسالة تبدأ بـ "معايير صارمة لـ PHP" أو بـ "PHP Derecated".  هذه الأخطاء هي رسالة معلومات موجهة إلى المطورين، وكثيرا ما تظهر بعد التثبيت أو الترقية.  إذا رأيت الكثير من أخطاء "المعايير الصارمة" في السجل الخاص بك، ابحث عن أخطاء أخرى.  ومع ذلك، بإمكانهم تلطيف سجل الأخطاء وجعل من الصعب مشاهدة الأخطاء الأخرى، بحيث يمكنك إزالتها من خلال القيام بما يلي:

1. البحث عن ملف `php.ini` وفتحه
2. حدد مكان القسم للإبلاغ عن الأخطاء وإعداداتك الخاصة
3. أضف `& ~E_STRIT` إلى نهاية خط الإبلاغ عن الأخطاء النشطة. على سبيل المثال إذا كان إعدادك الحالي هو `error_reporting = E_ALL & ~E_NOTICE & ~E_DEPRECATED` يمكنك تغييره إلى قراءة `error_reporting = E_ALL & ~E_NOTICE & ~E_DEPRECATED & ~E_STRICT`
4. حفظ وإغلاق الملف

### الاتصال بالدالة غير المحددة xml_parser_create

مثال:

```
خطأ فادح في PHP: اتصل إلى الدالة غير المحددة xml_parser_create() في /home/cimsur/ojs/lib/pkp/classes/xml/XMLParser.inc.php على السطر 271
```

يشير خطأ قاتل من `xml_parser_create` إلى أن PHP ليس لديه [ملحقات xml تمكين](http://php.net/manual/en/book.libxml.php). ألقي نظرة على تثبيت php الخاص بك أو اتصل بمضيف الويب الخاص بك لمعرفة ما إذا كنت تستطيع إضافة ملحق يسمى `libxml`.

### تم رفض الإذن

مثال:

```
تحذير: file_put_contents(/usr/share/ojs/ojs-3.0b1/cache/fc-locale-05afc2c4827ae11210c660d134ba1f01.php): فشل فتح البث: تم رفض الإذن في /usr/share/ojs/ojs-3.0b1/lib/pkp/classes/cache/FileCache.php على السطر 90
```

وهذا يشير عادة إلى أن النظام يحاول الكتابة إلى مجلد ولم يتم تعيين الأذونات بشكل صحيح في ذلك المجلد. تحقق من أن الأذونات في جميع المجلدات الخاصة بك قد تم تعيينها بشكل صحيح، وفقاً للتعليمات الواردة في [دليل مدير PKP](https://docs.pkp.sfu.ca/admin-guide/en/troubleshooting#permissions-file-access-etc).

### اتصل بوظيفة عضو… على غير كائن

مثال:

```
خطأ فادح: اتصل بوظيفة عضو getFullName() على غير كائن في /home/ojsepw/public_html/cache/t_compile/%%B0^B03^B0335942%%copyedit.tpl.php على السطر 20
```

يمكن أن يشير هذا الخطأ إلى أن القيمة مفقودة في قاعدة البيانات الخاصة بك.  على سبيل المثال، تم تعيين تسليم إلى مستخدم غير موجود لأن حساب المستخدم قد تم حذفه بطريقة ما.  يمكنك تشغيل برنامج نصي لتحديد البيانات المفقودة

### الملف غير موجود

مثال:

```
الأخطاء التي حدثت أثناء التثبيت: الدليل المحدد للملفات التي تم تحميلها غير موجود أو غير قابل للكتابة.
```

يمكن أن يحدث هذا أثناء التثبيت أو عندما تحاول تحميل أو الوصول إلى ملف.  كما يمكن أن يشير إلى مشاكل في الأذونات - انظر الخطأ الوارد أعلاه "الإذن مرفوض".

### لا يمكن استخدام قيمة النطاق كمصفوفة

مثال:

```
تحذير: لا يمكن استخدام قيمة النطاق كمصفوفة في المنزل/user/public_html/ojs/classes/journal/JournalSettingsDAO.inc.php في السطر 83
```

يحدث هذا عادة أثناء الترقية ويعني أن هناك عمود محلي فارغ في حالة يتوقع فيها OJS قيمة هناك، أو عمود محلي مع قيمة حيث كان OJS يتوقع عمودا فارغا.  يشير أحياناً إلى أن الترقية قد فشلت سابقاً، أو أصابت خطأً وتركت قاعدة البيانات في حالة غير متسقة.

لتعقب ذلك، حاول تشغيل الاستعلام التالي:

```
حدد DISTINCT s1.setting_name FROM journal_settings1, journal_settings2 WHERE s1.setting_name = s2.setting_name and s1.locale = '' and s2.locale <>';
```

هذا سيخبرك ما هي قيمة setting_name في journal_settings، أي أن لديه بعض القيم مع مجموعة عمود محلي، وبعضها الآخر فارغ.

**أو**

يمكنك تصحيح هذا عن طريق تحرير `lib/pkp/classes/core/DataObject.inc.php`، والعثور على السطر 133 أو نحو ذلك، والذي يجب أن يبدو مثل:

`$this->_data[$key][$locale] = $value;`

قبل ذلك مباشرة، يضاف ما يلي:

```php
إذا (isset($this->_data[$key]) && !is_array($this->_data[$key])) error_log('مختلط توطين لـ ' . get_class($this) . ', إعداد"' . $key . '"');
```

ثم قم بتفعيل التحذير مرة أخرى (على سبيل المثال عن طريق إعادة تحميل الصفحة التي رأيتها من قبل)، وابحث في السجل الخاص بك للحصول على مزيد من التفاصيل.

### خطأ في التحليل: خطأ في بناء الجملة، غير متوقع

مثال:

```
خطأ في التحليل: خطأ في بناء الجملة ، غير متوقع '[' في C:\inetpub\vve-site\api\vendor\nikic\fast-route\src\functions.php على السطر 12
```

قد يعني هذا أن الإصدار الخاص بك من PHP قديم ويجب عليك الترقية إلى الحد الأدنى لإصدار PHP المطلوب من التطبيق.

### رسالة خطأ عند التحميل: "لا يوجد ملف تم تحميله أو نوع غير صالح من الملفات!"

ولهذه الرسالة سببان مشتركان:

1. التحميلات في حالة فشل كامل. تحقق من أن إعدادات PHP تسمح بالتحميل.
2. الرفع ناجح، ولكن البرنامج يواجه مشكلة في التأكد من أنه النوع الصحيح من الملفات.

يستخدم برنامج PKP أنواع MIME للتأكد من أن الشعارات التي تم تحميلها هي في الواقع ملفات الصور. هناك العديد من الآليات التي قد تكون متاحة لـ PHP للقيام بذلك، اعتماداً على تكوين الخادم الخاص بك:

- ملحق `fileinfo` لـ PHP
- PHP’s `mime_content_type` function
- أداة ملف النظام

يحاول OJS 3.x هذه الترتيبات، باستخدام أول آلية ممكنة.

إذا كان تطبيق PKP الخاص بك يبدو أنه فشل في تحديد الملف الذي تقوم بتحميله، تأكد من…

- بالنسبة للصور، أنه من نوع مقبول. بالنسبة للصور، يفضل .png و .jpg. ملفات .gif غير مدعومة حالياً؛ ملفات .png أفضل لجميع الاستخدامات باستثناء الرسوم المتحركة. استخدم ملف .png لـ favicon.
- أن إعداد `mime_database_path` في `config.inc.php` صحيح. وينبغي أن يؤدي التعليق عليه إلى استخدام البرمجيات لقاعدة بيانات داخلية.

إذا لم تعمل هذه الوظائف، قد يكون عليك التحقق من تكوين النظام الخاص بك بشكل أوثق، على سبيل المثال لتحديد أي من الوظائف المذكورة أعلاه. وهذا سيتطلب بعض خبرات PHP.
