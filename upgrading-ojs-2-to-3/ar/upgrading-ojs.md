# ترقية مثيل OJS الخاص بك

سيغطي هذا الفصل الجوانب التقنية لترقية مثيل الويب الخاص بك إلى OJS 3.X. تخطيط ترقيتك سيقطع شوطا طويلا في جعل هذه العملية ناجحة. قبل إجراء أي ترقية، من المهم التأكد من أن الخادم الخاص بك يلبي [OJS 3. المتطلبات](https://pkp.sfu.ca/ojs/README) وأن تثبيت OJS 2.x ليس قديماً جداً بحيث لا يمكن ترقيته إلى OJS 3.X. بعد أن تقرر أن الخادم الخاص بك يفي بالمتطلبات التي يمكنك الاستمرار في ترقية OJS 3.X.

## الخطوة 1: إجراء ترقية صندوق الرمل
من المهم إجراء اختبار الترقية أولاً. للقيام بذلك، ستحتاج إلى إعداد نسخة كاملة من مجلة OJS 2.x الخاصة بك، بما في ذلك قاعدة البيانات ومنطقة الملفات. اتبع تعليمات الترقية على تلك النسخة. يمكن العثور على تعليمات الترقية الرسمية مباشرة في [وثائق التحديث الجرادي](https://pkp.sfu.ca/ojs/UPGRADE). هنا سوف تجد تعليمات للترقية من عدة إصدارات من OJS 2.x.

جعل موظفيك التقنيين على دراية بخطوات الترقية المضمنة في ملفات التحميل مع أحدث إصدار من OJS 3، متاح على موقع PKP على شبكة الإنترنت.

إنشاء صندوق رملي حيث يمكنك إجراء عملية ترقية تجريبية. هذا أيضا وقت مناسب لعمل نسخة احتياطية من التثبيت الخاص بك.

لصنع صندوق رملي، ستحتاج إلى فك حزمة الإصدار الجديد من OJS 3 إلى منطقة جديدة على خادم الويب الخاص بك (حيث لن يتدخل مع تثبيت OJS 2 الحالي)، وإنشاء نسخ من قاعدة البيانات الخاصة بك، ودليل الملفات، والدليل العام لاستخدامه في مربع OJS 3.

إجراء ترقية صندوق الرمل سيعطيكم مؤشرا على المدة التي ستستغرقها عملية الترقية وما إذا كانت هناك حاجة إلى أي تنظيف أو تغيير إضافي. كما يمكن أن يتيح فرصة لجولة بعض الميزات الجديدة في التقرير الثالث لمجلس العدل الإسلامي.

من أجل منع صندوق الرمل OJS 3 الخاص بك من الوصول أو الفهرسة عن طريق الخطأ، نوصي بالحد من الوصول إلى صندوق الرمل للمستخدمين المصرح لهم فقط عبر توجيه NoIndex أو المصادقة الأساسية المقدمة من خادم الويب الخاص بك. وعادة ما يتم إنجاز كل منهما باستخدام ملف .htacces، ولكن التفاصيل ستعتمد على تكوين خادم الويب الخاص بك.

قد ترغب أيضًا في منع تثبيت صندوق الرمل OJS 3 من إرسال رسائل البريد الإلكتروني إلى أشخاص حقيقيين أثناء إكمال التقييم والمراجعة. يمكنك القيام بذلك عن طريق تغيير عناوين البريد الإلكتروني في قاعدة بيانات صندوق الرمل باستخدام استعلام SQL هذا:

`تحديث المستخدمين تعيين البريد الإلكتروني = CONCAT(البريد الإلكتروني، 'اختبار')؛`

بعد ذلك، قم بتحرير `config.inc. hp` ملف التكوين في تثبيت صندوق الرمل لإضافة التفاصيل من تثبيت OJS 2 الحالي الخاص بك، ولكن تأكد من تحديد نسخ من قاعدة البيانات الخاصة بك ودليل الملفات بدلاً من إصدارات الإنتاج المستخدمة من خلال تثبيت OJS 2 الحالي. اتبع الإرشادات في `docs/UPGRADE` لترقية قاعدة البيانات. (سيؤدي هذا أيضا إلى إعادة ترتيب دليل الملفات الخاص بك، ولهذا السبب من المهم إنشاء نسخة!)

شاهد [قسم استكشاف الأخطاء تحت](#troubleshooting) لمعرفة الأخطاء المحتملة التي قد تواجهها أثناء عملية الترقية.

إذا اكتمل الترقية بنجاح، تسجيل الدخول إلى صندوق الرمل OJS 3 ومراجعة أن جميع العروض والملفات موجودة وأن كل شيء يتم عرضه بشكل صحيح.

بمجرد رضاك عن اختبار الترقية انتقل إلى الخطوة التالية.

## الخطوة 2 - إجراء الترقية
الآن بعد أن قمت باختبار ترقية صندوق الرمل وكنت راضيا عن النتائج، حان الوقت لترقية التثبيت الخاص بك. في اليوم المحدد، في الوقت المحدد، خذ OJS 2. قم بالمجلة دون اتصال واتبع التعليمات في `docs/UPGRADE` لترقية البرنامج. للقيام بذلك، سوف تكرر خطوات الترقية مع تثبيت الإنتاج الخاص بك. قبل ترقية التثبيت، قم بإجراء نسخة احتياطية كاملة من مجلد قاعدة البيانات و "الملفات". إذا فشلت عملية الترقية، سوف تحتاج إلى استعادة من النسخة الاحتياطية قبل المتابعة. يمكن العثور على تعليمات الترقية الرسمية مباشرة في [وثائق التحديث الجرادي](https://pkp.sfu.ca/ojs/UPGRADE). عند اكتمال الترقية بنجاح، أبلغ المحررين حتى يتمكنوا من تسجيل الدخول وبدء العمل.

إذا كان تثبيت OJS الخاص بك لا يحتوي بالفعل على مجلد "الملفات" خارج تثبيت OJS الذي يمكن الوصول إليه، يرجى نقله الآن. وعدم تلبية هذا الشرط هو الخطر الأمني الكبير الوحيد الذي تواجهه مجلات OJS. انظر قسم "التشكيل الموصى به" من وثيقة README المضمنة في ملفات تحميل OJS للحصول على التفاصيل.

## استكشاف الأخطاء

### رسائل خطأ قاتلة أثناء عملية الترقية
وهذا يشير عادة إلى أن هناك عدم اتساق في البيانات في قاعدة بيانات OJS 2.x الخاصة بك؛ ابحث في [منتدى مجتمع PKP](https://forum.pkp.sfu.ca/) عن رسائل مماثلة.

### تحذيرات من النموذج "إشعار PHP: غير تسلسلي(): خطأ عند الإزاحة…"
وهذا يشير إلى أنك ربما قمت عن طريق الخطأ بتغيير تكوين مجموعة الأحرف في `config.inc.php` أو أثناء إنشاء قاعدة بيانات sandbox الخاصة بك.

### رسالة خطأ "أمر القطران غير متوفر. الرجاء تكوينه بشكل صحيح في 'config.inc.php'' الخاص بك
هذه رسالة خطأ شائعة قد تخرج عند محاولة تمكين الإضافات. يحتوي [منتدى مجتمع PKP](https://forum.pkp.sfu.ca/) على عدد من الحلول المقترحة.

### خطأ في ترقية قاعدة البيانات
وهذا يدل عادة على أن بعض الأشياء غير متكافئة أو متكررة. يجب عليك إلقاء نظرة على قاعدة البيانات الموجودة لديك والتأكد من أن كل شيء هو نفسه أو لم يتم تكراره

للحصول على المزيد من موارد الترقية راجع قسم [الموارد الإضافية](./resources.md) في نهاية هذا الدليل.
