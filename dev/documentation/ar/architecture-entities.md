---
title: الكيانات - الوثائق التقنية - OJS<unk> OMP<unk> OPS
---

# الكيانات

الكيان هو أي نوع من الأشياء في الطلب، مثل التقديم أو إعادة النظر أو المناقشة أو الملف.

ويرد وصف لكل كيان في ملف مخطط ويكون ممثلا في الطلب بما يلي:

- فئة `DataObobjec` [](#dataobject-class) لكائنات هذا الكيان.
- خدمة [](./architecture-services)، مثل `خدمة التقديم`، للحصول على هذه العناصر والتحقق من صحتها وإضافتها وتحريرها وحذفها.
- [كائن الوصول إلى البيانات](#schemadao)، مثل `SubmissionDAO`، للتواصل بين الكائنات وقاعدة البيانات.
- json [schema](#schemas) الذي يحدد الخصائص والإفتراضات وقواعد التحقق لهذه الأشياء.
- [APIHandler](./architecture-handlers)، مثل `SubmissionHandler`، الذي يخدم نقطة نهاية REST API لهذه العناصر.

## فئة البيانات

يقدم صف `DataObobjec` API بسيط للحصول على البيانات لكائن ما وتعيينها.

> **تلميح:** `بيانات الكائن`s تؤدي دور `الطراز`ثانية في بنية تطبيق MVC (Model-View-Controller). 
> 
> {:.tip}

إنشاء كائن جديد.

```php
استيراد ('classes.journal.Journal');
$journal = مجلة جديدة();
```

تعيين بيانات على كائن.

```php
$journal->setData('تمكين'، صحيح)؛
```

احصل على بيانات من كائن.

```php
$isEnabled = $journal->getData('تمكين')؛
```

بعض البيانات متعددة اللغات وتخزن القيم لكل محلة. اجتياز رمز اللغة للحصول على قيمة مترجمة.

```php
$name = $journal->getLocalizedData('name', 'en_US');
```

عندما تحذف المعلمة المحلية فإنه سوف يعيد قيمة اللغة المحلية النشطة حاليا أو يعود إلى اللغة المحلية الأساسية للمجلة.

```php
$name = $journal->getLocalizedData('name');
```

> كائن `التقديم` يعمل بشكل مختلف. وسيعود إلى الموقع المحلي للطلب، وليس إلى الموقع الرئيسي للمجلة. 
> 
> {:.notice}

تعيين البيانات المترجمة عن طريق المرور على جميع المواقع في وقت واحد.

```php
$name = $journal->setData('name', [
    'en_US' => 'Journal of Public Knowledge',
    'fr_CA' => 'Journal de la connaissance du public',
])؛
```

أو حدد رمز الإعدادات المحلية عند تعيين البيانات.

```php
$name = $journal->setData('name', 'Journal of Public Knowledge', 'en_US');
```

### Helpers

قد تحتوي فئة `DataObobjec` على أساليب مساعدة إضافية لتجميع أو تنسيق البيانات المطلوبة. على سبيل المثال، توفر فئة `المشكلة` طريقة لإرجاع سلسلة مع الحجم والرقم والسنة والعنوان.

```php
$issue->setData('الحجم', 3);
$issue->setData('number', 2);
$issue->setData('year', 1983);
$issue->setData('title', 'عدد خاص عن الكائنات المجهرية', 'en_US');

صدى $issue->getIssueIdentification();
/Vol 3 No 2 (1983) عدد خاص عن الكائنات المجهرية
```

### عدم الوصول إلى قاعدة البيانات

يجب ألا يصل فصل `DataObobjec` إلى قاعدة البيانات مباشرة. إذا كانت طريقة المساعد تتطلب كائنا آخر، فينبغي إرسالها كمعلمة إلى الطريقة.

## Schemas

يتم تعريف الكيانات باستخدام إصدار موسع من [json-schema](http://json-schema.org/)، بناء بناء جملة JSON لتوثيق خصائص الكائن.

مخطط بسيط ذو خصيتين، `معرف` و `عنوان`، سيبدو هكذا .

```json
{
  "title": "مثال"،
  "وصف": "مثال لعنصر يوضح مخططاً. ,
  "خصائص": {
    "معرف": {
      "نوع": "عدد صحيح"،
      "مقروءة": صحيح
    }،
    "عنوان": {
      "نوع": "سلسلة"
    }
  }
}
```

تم توثيق بناء الجملة json-schema في [هذه الأمثلة](http://json-schema.org/learn/getting-started-step-by-step.html).

> **تلميح:** JSON هي صيغة أكثر صرامة من جافا سكريبت. استخدم [JSONLint](https://jsonlint.com/) لتحديد الأخطاء في المخطط الخاص بك. 
> 
> {:.tip}

### ملحقات المخطط

ويوثق الفرع الوارد أدناه كيف قمنا بتعديل أو توسيع نطاق صيغة json-schema لتتناسب مع احتياجاتنا.

#### أشكال التاريخ والوقت

نحن لا نستخدم صيغة json-schema's `التاريخ` و `datetime`. وبدلا من ذلك، نحن نستخدم `date-iso` (`YYYY-MM-DD`) و `date-time iso` (`YYY-MM-DD HHH:MM:SS`) لمطابقة تاريخنا الخاص / وقتنا بشكل أدق.

#### قراءة فقط

تعيين هذه السمة إلى خصائص لا يمكن تحريرها، مثل معرفات الكائن و عناوين URLs.

#### كتابة فقط

تعيين هذه السمة إلى الخصائص المستخدمة عند إضافة أو تحرير كائن ولكن لن يتم إرجاعها عند طلب الكائن.

مثال على هذه السمة هو `مؤقت` الذي يستخدم لحفظ ملف ولكن يتم تجاهله.

#### apiSummary

تعيين هذه السمة إلى الخصائص التي تريد أن تظهر في ملخص المشاهدات للكائن. عادة ما يستخدم عرض الملخص في نقاط النهاية التي ترجع قائمة العناصر.

#### الافتراضي LocaleKey

تعيين هذه السمة عندما يجب تعريب القيمة الافتراضية للخاصية. يجب أن تتطابق القيمة مع مفتاح محلي.

#### التحقق

تعيين هذه السمة إلى الخصائص التي يجب التحقق من صحتها قبل حفظها في قاعدة البيانات. نحن لا نؤيد قواعد التحقق الموحدة لـ json-schema. انظر [المصادقة](./utilities-validation).

#### متعددة اللغات

تعيين هذه الخاصية إلى البيانات التي يمكن أن تكون في أكثر من بلدة واحدة.

```json
{
  ...
  "خصائص": {
    "عن": {
      "نوع": "سلسلة"،
      "تعدد اللغات": صحيح
    }
  }
}
```

يتوقع التطبيق أن يتفاعل مع هذه الخاصية كما لو أنها كائن محلي.

```json
{
  "en_US": "حول الصحف...",
  "fr_CA": "propos du Journ..."
}
```

سيتم تطبيق أي قواعد تحقق على كل قيمة محلية في المجموعة.

> ومن المتوقع أن تكون البيانات الموصوفة بأنها جسم في نظام Json-schema مصفوفة مترابطة في نظام PHP. 
> 
> {:.warning}

### خصائص التطبيق

وعندما تضاف ممتلكات إلى كيان ما في طلب واحد وليس في طلب آخر، تستخدم ملفين مخططين تحمل نفس الاسم.

`لوب/pkp/schemas/context.json`

```json
{
    "title": "سياق"،
    "وصف": "مجلة أو صفحة. ,
    "النوع": "الكائن"
    "خصائص": {
        "عن": {
            "نوع": "سلسلة"،
            "تعدد اللغات": صحيح
    }
  }
}
```

`المخطط/context.json`

```json
{
    "title": "Journal",
    "Destion": "مجلة ,
    "خصائص": {
        "اختصار": {
            "نوع": "سلسلة"،
            "تعدد اللغات": صحيح
    }
  }
}
```

وسيتم دمج ملفات المخططات هذه لوضع مخطط موحد. وعندما تكون هناك خصائص متطابقة، فإن مخطط التطبيق سيغلب على مخطط المكتبة.

## SchemaDAO

عندما يكون لدى كيان ما مخططاً، فإنه [DAO](./architecture-database) يجب أن يوسع `SchemaDAO`. وسوف تستخدم هذه الفئة ملف المخطط لضمان أن تكون البيانات التي تُقرأ من قاعدة البيانات وكتبت إليها متفقة مع المخطط.

## وثائق API

تستخدم ملفات المخطط لإنشاء [وثائق API](/dev/api).

## مخططات تمديد

يمكن استخدام الروابط لإضافة أو تعديل أو إزالة خصائص الكيان.

إضافة خاصية `مؤسسة` إلى الكيان `السياق`.

```php
سجل::register('Schema::get::context', function($hookName, $args) {
    $schema = $args[0];
    $schema->خصائص ->مؤسسة البيت = (كائن) [
        'نوع' => 'سلسلة',
        'apiSummary' => صحيح,
        'تعدد اللغات' => صحيح,
        'المصادقة' => ['nullable']
    ]؛
})؛
```

يتطلب اختصار المجلة أن يكون 3 أحرف أو أقل.

```php
سجل::register('Schema::get::context', function($hookName, $args) {
    $schema = $args[0];
  إذا (! roperty_available ($schema->خصائص, 'المختصر')) {
    العودة؛
  }
  $schema->خصائص ->المختصر>التحقق = ['max:3'];
})؛
```

إذا كان الكود الخاص بك سيتم تضمينه في التطبيق، فمن الأفضل إضافة الخاصية مباشرة إلى المخطط.

---

تعرف على المزيد حول [كيفية تخزين الكيانات في قاعدة البيانات](./architecture-database).