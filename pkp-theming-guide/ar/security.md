# أمان

ويعالج تطبيق OJS أو OMP معظم الشواغل الأمنية التي تنشأ. ومع ذلك، هناك بعض الهجمات التي يجب عليك أن تحمي نفسك منها عند إنشاء قوالب مخصصة للموضوعات الخاصة بك.

[تعرّض البرنامج النصي عبر الموقع](https://en.wikipedia.org/wiki/Cross-site_scripting) يحدث عندما يكون المستخدم الخبيث قادراً على حقن الكود البرمجي في صفحة يزورها مستخدم آخر. كلما كان المحتوى المعروض على الصفحة يأتي من إدخال المستخدم، يجب الإفلات منه.

## نص عادي للهروب

ولنتأمل هنا المثال التالي.

```php
{$user->getGivenName()} قدم تعليق.
```

يمكن للمستخدم الخبيث تغيير اسمه المعطى إلى `<script>/* رمز خبيث */<script>`. في المثال الوارد أعلاه، سيتم تنفيذ التعليمات البرمجية الخبيثة كلما زار _أي شخص_ الصفحة. إذا قام مدير يومية بزيارة الصفحة، يمكن استخدام الرمز الخبيث لتنفيذ الإجراءات التي يمكن أن يقوم بها مدير اليومية فقط، مثل تغيير عنوان المجلة.

استخدم معدل [الهروب الذكي](https://www.smarty.net/docs/en/language.modifier.escape.tpl) لمنع هذا الهجوم،

```php
{$user->getGivenName()<unk> escape} قدم تعليق.
```

سيؤدي هذا إلى تحويل أحرف HTML الخاصة إلى هروب HTML بحيث يتم عرض العلامات `<script>` بدلاً من تنفيذها.

الهجمات يمكن أن تأتي من أي إدخال يسيطر عليه المستخدم، سواء كانوا محرراً سابقاً للقسم ساخطين أو مستخدمين كيدين يتصرفون كمؤلف. تأكد من التهرب من عناوين التقديم، وأسماء المؤلف، وإصدار العناوين وأي معلومات أخرى يتحكم فيها أي شخص غير مدير اليومية.

```php
{$submission->getlocalizedTitle()<unk> escape}
{$author->getFullName()<unk> escape}
{$issue->getIssueIdentification()<unk> escape}
```

## هروب HTML

تسمح بعض الحقول للمستخدم بإدخال رمز HTML، مثل خلاصة الإرسال أو وصف المشكلة. يجب الإفلات من هذه الحقول مع تعديل `strip_unsafe_html`.

```php
{$submission->getLocalizedAbstract()<unk> strip_unsafe_html}
{$issue->getLocalizedDescription()<unk> strip_unsafe_html}
```

يمكنك تكوين وسوم HTML المسموح بها مع إعداد `allowed_html` في ملف تكوين التطبيق.

## الهروب من جافا سكريبت

عند إدراج جافا سكريبت في الموضوع الخاص بك، لا تستخدم معدل `الهروب` لأنه لن يزيل الأحرف المناسبة. لاستخدام JavaScript، استخدم معدّل `json_encode` عند تضمين مدخلات المستخدم.

```
<script>
    alert({$userMessage<unk> json_encode<unk> default:""});
</script>
```

هذا سيضمن تضمين المحتوى الحرفي فقط وليس تشغيل المكالمات أو شفرة أخرى يمكن أن تكون ضارة. سيمنع المعدّل `الافتراضي` خطأ في جافا سكريبت إذا كان `{$userMessage}` `فارغًا`.

## كن حذرا، ابقى آمناً

من المهم أن نفهم نوع الهروب الذي يجب أن تستخدمه استنادًا إلى المكان الذي تستخدم فيه البيانات المقدمة من المستخدم. إذا كان هناك شك، قم باتباع مثال آمن من رمز التطبيق الأساسي أو [اسأل في المنتدى](https://forum.pkp.sfu.ca/).

يجب عليك *دائما تقريبا* استخدام نوع من الهروب عند تضمين المحتوى الديناميكي في قالب Smarty .
